
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:i18n="http://innolux.com/i18n"
	template="/faces/template/template.xhtml">
	<ui:define name="page-content">
		<ui:include src="../CommonView/fileUpload.xhtml" />
		<p:tabView id="tabView" cache="true"
			activeIndex="#{ApplyClassstructureBean.classstructureForm.activeIndex}">


			<p:tab id="tab1">
				<f:facet name="title">
					<i18n:outputText value="item.Classstructure.apply" />
					<i18n:outputText value="list" />
				</f:facet>
				<h:form id="form" prependId="false">

					<p:dataTable var="listClassstructureHeaderApply"
						paginatorPosition="bottom"
						value="#{ApplyClassstructureBean.classstructureForm.listClassstructureHeaderApply}"
						rowKey="#{listClassstructureHeaderApply.applyHeaderId}"
						paginator="true" rows="10"
						selection="#{ApplyClassstructureBean.classstructureForm.classstructureHeaderApply}"
						selectionMode="single" id="listClassstructureHeaderApply">

						<p:ajax event="rowSelect"
							listener="#{ApplyClassstructureBean.selectClassstructureHeaderApply}"
							update=":tabView"
							
							 />

						<p:column style="text-align:center"
							sortBy="#{listClassstructureHeaderApply.applyHeaderNum}">
							<f:facet name="header">
								<i18n:outputText value="apply.num" />
							</f:facet>
							<h:outputText
								value="#{listClassstructureHeaderApply.applyHeaderNum}" />

						</p:column>
						<p:column style="text-align:center"
							sortBy="#{listClassstructureHeaderApply.action}">
							<f:facet name="header">
								ACTION
							</f:facet>
							<h:outputText
								value="#{SystemConfigBean.parameterMap[listClassstructureHeaderApply.action]}" />

						</p:column>
						<p:column style="text-align:center"
							sortBy="#{SystemConfigBean.parameterMap[listClassstructureHeaderApply.status]}">
							<f:facet name="header">
								<i18n:outputText value="status" />
							</f:facet>
							<h:outputText
								value="#{SystemConfigBean.parameterMap[listClassstructureHeaderApply.status]}" />
						</p:column>
						<p:column
							sortBy="#{ApplyClassstructureBean.classstructureForm.signMap[listClassstructureHeaderApply.taskId].actorName}">
							<f:facet name="header">
								<i18n:outputText value="wait.sign" />
							</f:facet>
							<h:outputText
								value="#{ApplyClassstructureBean.classstructureForm.signMap[listClassstructureHeaderApply.taskId].actorName}" />

						</p:column>
						<p:column style="text-align:center">
							<f:facet name="header">
								<i18n:outputText value="siteid" />
							</f:facet>
							<h:outputText
								value="#{SystemConfigBean.locationMapALL[listClassstructureHeaderApply.organizationCode]}" />
						</p:column>
						<p:column style="text-align:center"
							sortBy="#{listClassstructureHeaderApply.classstructureid}">
							<f:facet name="header">
								<i18n:outputText value="class_structure_id" />
							</f:facet>
							<h:outputText
								value="#{listClassstructureHeaderApply.classstructureid}" />
						</p:column>
						<p:column style="text-align:center"
							sortBy="#{listClassstructureHeaderApply.createBy}">
							<f:facet name="header">
								<i18n:outputText value="apply.by" />
							</f:facet>
							<h:outputText value="#{listClassstructureHeaderApply.createBy}" />

						</p:column>
						<p:column style="text-align:center"
							sortBy="#{listClassstructureHeaderApply.deptcode}">
							<f:facet name="header">
								<i18n:outputText value="dept_code" />
							</f:facet>
							<h:outputText value="#{listClassstructureHeaderApply.deptcode}" />
						</p:column>
						<p:column sortBy="#{listClassstructureHeaderApply.createDate}"
							style="text-align:center">
							<f:facet name="header">
								<i18n:outputText value="pr_issue_date" />
							</f:facet>
							<h:outputText value="#{listClassstructureHeaderApply.createDate}">
								<f:convertDateTime pattern="yyyy-MM-dd" timeZone="GMT+8" />
							</h:outputText>
						</p:column>
						<p:column sortBy="#{listClassstructureHeaderApply.headerRemark}">
							<f:facet name="header">
								<i18n:outputText value="command" />
							</f:facet>
							<h:outputText
								value="#{listClassstructureHeaderApply.headerRemark}"
								style="white-space: pre-wrap; word-wrap: break-word;" />
						</p:column>
					</p:dataTable>
				</h:form>
			</p:tab>
			<p:tab id="tab2">
				<f:facet name="title">
					<i18n:outputText value="Apply.Info" />
				</f:facet>
				<ui:include src="applyClassstructure.xhtml"></ui:include>
			</p:tab>
		</p:tabView>
		<p:confirmDialog id="submitConfirmDialog" message="確定送審類別結構屬性清單申請"
			header="確定類別結構屬性清單申請" widgetVar="submitConfirmDialog"
			appendTo="@(body)">
			<h:form id="submitConfirmDialogForm" prependId="false">
			 	<p:panelGrid style="width:100%;text-align:center;word-break:break-all;">
					<p:row>
						<p:column colspan="3"> 簽核說明 : </p:column> 
					</p:row>
					<p:row>
						<p:column colspan="3">
						 <p:inputTextarea rows="6" cols="60"
								value="#{ApplyClassstructureBean.classstructureForm.signComment}" maxlength="350" 
								style="width:100%" />
						</p:column>
					</p:row>
				</p:panelGrid>
				<p:commandButton value="Yes Sure"
					oncomplete="PF('submitConfirmDialog').hide();"
					actionListener="#{ApplyClassstructureBean.Submit('submit')}"
					update=":tabView" 
					 icon="ui-icon-circle-check" />
				<p:commandButton value="Not Yet"
					onclick="PF('submitConfirmDialog').hide();" type="button"
					icon="ui-icon-close" />
			</h:form>
		</p:confirmDialog>
		<p:confirmDialog id="deleteConfirmDialog" message="確定刪除類別結構屬性清單申請"
			header="刪除申請單" widgetVar="deleteConfirmDialog" appendTo="@(body)">
			<h:form id="DeleteConfirmDialogForm" prependId="false">
				<p:commandButton value="Yes Sure"
					onclick="PF('deleteConfirmDialog').hide();"
					actionListener="#{ApplyClassstructureBean.onDelete}"
					update=":tabView" 
					 icon="ui-icon-circle-check" />
				<p:commandButton value="Not Yet"
					onclick="PF('deleteConfirmDialog').hide();" type="button"
					icon="ui-icon-close" />
			</h:form>
		</p:confirmDialog>
		<p:dialog id="listClassstructureFormDialog" header="分類"
			widgetVar="listClassstructureFormDialog" modal="true"
			appendTo="@(body)" width="750" height="400">
			<ui:include src="../CommonView/listClassstructure.xhtml" />
		</p:dialog>
		<p:dialog id="signPreViewDialog" header="簽核預覽"
			widgetVar="signPreViewDialog" modal="true" appendTo="@(body)">
			<h:panelGrid id="signPreView" columns="1" cellpadding="1">
				<iframe width="650" frameborder="0" name="ifrm02" id="ifrm02"
					src="#{ApplyClassstructureBean.classstructureForm.signPreViewUrl}"
					onload="document.getElementById('ifrm02').height=(ifrm02.document.body.scrollHeight+50)+'px'" />
			</h:panelGrid>
		</p:dialog>
	</ui:define>
</ui:composition>
