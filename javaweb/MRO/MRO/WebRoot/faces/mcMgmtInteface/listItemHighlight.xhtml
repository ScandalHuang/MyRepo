
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:i18n="http://innolux.com/i18n">
	<h:form id="listItemHighlightForm" prependId="false">
		<p:defaultCommand target="highlightSearch" />
		<center>
			<p:panelGrid id="HighlightHeader" style="white-space:nowrap;">
				<f:facet name="header">
					<p:row>
						<p:column colspan="8">
							<i18n:outputText value="r2.item.highlight.search" />
						</p:column>
					</p:row>
				</f:facet>
				<p:row>
					<p:column>
						處理狀態
					</p:column>
					<p:column>
						Monitor_Type
					</p:column>
					<p:column >
						<i18n:outputText value="ItemCategory" />
					</p:column>
					<p:column rendered="#{ListHighlightBean.highlightForm.editButton}">
						<i18n:outputText value="lastest.response" />
					</p:column>
					<p:column>
						<i18n:outputText value="itemnum" />
					</p:column>
					<p:column>
						<i18n:outputText value="binnum" />
					</p:column>
					<p:column>
						<i18n:outputText value="site" />
					</p:column>
					<p:column></p:column>
				</p:row>
				<p:row>
					<p:column>
						<p:selectOneMenu
							value="#{ListHighlightBean.highlightForm.searchHistory}">
							<f:selectItem itemLabel="ALL" itemValue="true" />
							<f:selectItem itemLabel="未處理" itemValue="false" />
						</p:selectOneMenu>
					</p:column>
					<p:column>
						<i18n:outputText value='sumofcounter.to.little' var="m1">
							<i18n:outputText value='control.to.high' var="m2">
								<p:selectOneMenu
									value="#{ListHighlightBean.highlightForm.monitorType}">
									<f:selectItem itemLabel="請選擇" itemValue="" />
									<f:selectItem itemLabel="#{m1}" itemValue="Y" />
									<f:selectItem itemLabel="#{m2}" itemValue="N" />
								</p:selectOneMenu>
							</i18n:outputText>
						</i18n:outputText>
					</p:column>
					<p:column >
						<p:selectOneMenu
							value="#{ListHighlightBean.highlightForm.selectItemCategory}">
							<f:selectItem itemLabel="請選擇" itemValue="" />
							<f:selectItems
								value="#{ListHighlightBean.highlightForm.itemCategoryOption}" />
							<p:ajax update="reasonType" process="@this" />
						</p:selectOneMenu>
					</p:column>
					<p:column rendered="#{ListHighlightBean.highlightForm.editButton}">
						<p:selectOneMenu id="reasonType"
							value="#{ListHighlightBean.highlightForm.reasonType}">
							<f:selectItem itemLabel="請選擇" itemValue="" />
							<f:selectItems
								value="#{ListHighlightBean.highlightForm.reasonOption[
								ListHighlightBean.highlightForm.selectItemCategory]}" />
						</p:selectOneMenu>
					</p:column>
					<p:column>
						<p:inputText
							value="#{ListHighlightBean.highlightForm.selectitemnum}"
							size="15" id="selectitemnumH" />
						<p:commandButton icon="ui-icon-search"
							style="width:24px;height:24px;"
							oncomplete="PF('listItemCommonFormDialog').show();">
							<f:setPropertyActionListener
								target="#{ListItemCommonBean.object}"
								value="#{ListHighlightBean}" />
							<f:setPropertyActionListener
								target="#{ListItemCommonBean.updateView}"
								value="tabView:selectitemnumH" />
						</p:commandButton>
					</p:column>
					<p:column>
						<p:inputText
							value="#{ListHighlightBean.highlightForm.selectDeptcode}"
							size="10"
							rendered="#{ListHighlightBean.highlightForm.editButton}" />
						<p:inputText
							value="#{ListHighlightBean.highlightForm.selectDeptcode}"
							readonly="true" size="10"
							rendered="#{!ListHighlightBean.highlightForm.editButton}" />
					</p:column>
					<p:column>
						<p:selectOneMenu
							value="#{ListHighlightBean.highlightForm.selectSiteId}"
							filter="true" filterMatchMode="startsWith" style="width:150px;"
							height="150">
							<f:selectItem itemLabel="請選擇" itemValue="" />
							<f:selectItems
								value="#{ListHighlightBean.highlightForm.organizationOption}" />
						</p:selectOneMenu>
					</p:column>
					<p:column>
						<p:commandButton icon="ui-icon-search" value="Search"
							id="highlightSearch" actionListener="#{ListHighlightBean.search}"
							update="listHighlight" style="margin-top:5px" />
					</p:column>
				</p:row>
			</p:panelGrid>
		</center>
		<br />
		<font color="BLUE"> 1.
			原控管人若調部門，部門代碼已與控管部門不同，故無法修改，須由控管部門人員修改，若下修為 0，系統將 mail 通知原控管人。<br />
			2. R1耗材：回覆後當月不再 Monitor ; Spare parts：回覆後1個月內不再
			Monitor。物管可針對回覆不合理項目重啟 Monitor 機制。<br />
			3. 近3個月有修正控管量者不 Monitor ;<br />
		</font>
		<font color="RED"> 4. 選擇「無需求，下修為 0」&#38;「未符合R1控管量控管標準，下修為
			0」，會自動產生下修為 0 控管申請單並送審。
			<br /> 5. 7日未回覆或第二次 Monitor，系統直接下修控管量為 0 或 建議值。
			<br/>6. 近半年領耗用次數未達3次='Y',建議量=0；近半年領耗用次數未達3次='N',建議量=近三個月平均月領耗用數量
		</font>
		<br />
		<br />
		<p:dataTable var="listHighlight" paginatorPosition="bottom"
			value="#{ListHighlightBean.highlightForm.listHighlight}"
			paginator="true" rowKey="#{listHighlight['ROWNUM']}" rows="10"
			id="listHighlight">
			<f:facet name="header" style="text-align:left;">  
			        搜尋筆數共：  #{ListHighlightBean.highlightForm.listHighlight.size()} 筆
			        </f:facet>
			<p:column style="text-align:center;width:20px;" exportable="false">
				<f:facet name="header">
					回覆區
				</f:facet>
				<p:commandButton icon="ui-icon-search"
					style="width:20px;height:20px;" update=":listHighlightLogForm"
					action="#{ListHighlightLogBean.searchLog}"
					oncomplete="PF('listHighlightLogDialog').show();" title="Search">
					<f:setPropertyActionListener
						target="#{ListHighlightLogBean.highlightForm.mroInvbalancesHighlightV}"
						value="#{listHighlight}" />
					<f:setPropertyActionListener
						target="#{ListHighlightLogBean.highlightForm.editButton}"
						value="#{ListHighlightBean.highlightForm.editButton}" />
					<f:setPropertyActionListener
						target="#{ListHighlightLogBean.highlightForm.updateView}"
						value="tabView:listHighlight" />
					<f:setPropertyActionListener
						target="#{ListHighlightLogBean.highlightForm.object}"
						value="#{ListHighlightBean}" />
				</p:commandButton>

			</p:column>
			<p:column sortBy="#{listHighlight.highlightInitialDate}">
				<f:facet name="header">
					Initial Date
				</f:facet>
				<h:outputText value="#{listHighlight.highlightInitialDate}">
					<f:convertDateTime pattern="yyyy-MM-dd" timeZone="GMT+8" />
				</h:outputText>
			</p:column>
			<p:column sortBy="#{listHighlight.fab}">
				<f:facet name="header">
					FAB
				</f:facet>
				<h:outputText value="#{listHighlight.fab}" />
			</p:column>
			<p:column sortBy="#{listHighlight.shop}">
				<f:facet name="header">
					SHOP
				</f:facet>
				<h:outputText value="#{listHighlight.shop}" />
			</p:column>
			<p:column sortBy="#{listHighlight.binnum}">
				<f:facet name="header">
					DEPT
				</f:facet>
				<h:outputText value="#{listHighlight.binnum}" />
			</p:column>
			<p:column sortBy="#{listHighlight.itemnum}">
				<f:facet name="header">
					ITEM
				</f:facet>
				<h:outputText value="#{listHighlight.itemnum}" />
			</p:column>
			<p:column sortBy="#{listHighlight.stock}">
				<f:facet name="header">
					ERP目前存量
				</f:facet>
				<h:outputText value="#{listHighlight.stock}" />
			</p:column>
			<p:column sortBy="#{listHighlight.idledays}">
				<f:facet name="header">
					呆滯天數
				</f:facet>
				<h:outputText value="#{listHighlight.idledays}" />
			</p:column>
			<p:column sortBy="#{listHighlight.reasonType}">
				<f:facet name="header">
					最新回覆
				</f:facet>
				<h:outputText
					value="#{SystemConfigBean.parameterMap[listHighlight.reasonType]}" />
			</p:column>
			<p:column sortBy="#{listHighlight.createDate}">
				<f:facet name="header">
					最新回覆時間
				</f:facet>
				<h:outputText value="#{listHighlight.createDate}">
					<f:convertDateTime pattern="yyyy-MM-dd" timeZone="GMT+8" />
				</h:outputText>
			</p:column>
			<p:column sortBy="#{listHighlight.description}">
				<f:facet name="header">
					DESCRIPTION
				</f:facet>
				<h:outputText value="#{listHighlight.description}" />
			</p:column>
			<p:column sortBy="#{listHighlight.displayName}">
				<f:facet name="header">
					OWNER
				</f:facet>
				<h:outputText value="#{listHighlight.displayName}" />
			</p:column>
			<p:column sortBy="#{listHighlight.sumofconter}">
					<f:facet name="header">
						近半年[主+替]<br/>領/耗用用次數
					</f:facet>
					<h:outputText value="#{listHighlight.sumofconter}" />
				</p:column>
				<p:column sortBy="#{listHighlight.avghdqtyThree}">
					<f:facet name="header">
						近三個月平均<BR/>月領/耗用數量
					</f:facet>
					<h:outputText value="#{listHighlight.avghdqtyThree}" />
				</p:column>
				
				<p:column sortBy="#{listHighlight.mcMinPackageQuantity}">
					<f:facet name="header">
						MPQ
					</f:facet>
					<h:outputText value="#{listHighlight.mcMinPackageQuantity}" />
				</p:column>
				<p:column sortBy="#{listHighlight.oriavguseqty}">
					<f:facet name="header">
						R2平均月耗用量
					</f:facet>
					<h:outputText value="#{listHighlight.oriavguseqty}" />
				</p:column>
				<p:column sortBy="#{listHighlight.sstock}">
					<f:facet name="header">
						R2最低安全存量
					</f:facet>
					<h:outputText value="#{listHighlight.sstock}" />
				</p:column>
				<p:column sortBy="#{listHighlight.minlevel}">
					<f:facet name="header">
						R1月用量/<br/>R2重訂購量
					</f:facet>
					<h:outputText value="#{listHighlight.minlevel}" />
				</p:column>
			<p:column sortBy="#{listHighlight.threeMonthAvgRecommand}">
				<f:facet name="header">
						建議量
					</f:facet>
				<h:outputText value="#{listHighlight.threeMonthAvgRecommand}" />
			</p:column>
			<p:column>
				<f:facet name="header">
					近半年領耗用<br/>次數未達3次
				</f:facet>
				<h:outputText value="#{listHighlight.sumofconterFlag}" />
			</p:column>
			<p:column>
				<f:facet name="header">
					控管量高估
				</f:facet>
				<h:outputText value="#{listHighlight.threeMonthAvgFlag}" />
			</p:column>
		</p:dataTable>
		<p:panelGrid columns="2">
			<p:panel header="Export All Data">
				<h:commandLink>
					<p:graphicImage value="../../resources/images/excel.png" />
					<p:dataExporter type="xls" target="listHighlight"
						fileName="HighlightList_ALL" />
				</h:commandLink>
			</p:panel>

			<p:panel header="Export Page Data">
				<h:commandLink>
					<p:graphicImage value="../../resources/images/excel.png" />
					<p:dataExporter type="xls" target="listHighlight"
						fileName="HighlightList_Page" pageOnly="true" />
				</h:commandLink>
			</p:panel>
		</p:panelGrid>
		
	</h:form>
</ui:composition>
