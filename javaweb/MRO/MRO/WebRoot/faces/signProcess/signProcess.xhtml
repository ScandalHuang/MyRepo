<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:i18n="http://innolux.com/i18n">
	<h:form id="signProcessForm" prependId="false">
		<h:panelGrid columns="5" cellpadding="2">
			<p:commandButton value="New" update=":tabView"
				icon="ui-icon-plus" actionListener="#{SignProcessBean.onNew}"
				
				 />
			<p:commandButton value="儲存" update=":tabView"
				icon="ui-icon-disk" actionListener="#{SignProcessBean.onSave}"
				rendered="#{SignProcessBean.signProcessForm.signProcess!=null}"
				
				 />
		</h:panelGrid>
		<p:separator />
		<p:panelGrid id="header" style="width:100%;word-break:break-all;">
			<f:facet name="header">
				<p:row>
					<p:column colspan="4">
					請在下方欄位輸入簽核清單的設定，有註記<i18n:outputText style="color:red;"
							value="NonNull" />，請務必填寫，完成後請點選「儲存」按鍵進行儲存
				</p:column>
				</p:row>
			</f:facet>
			<p:row>
				<p:column style="width:120px">
				簽核清單編號：
			</p:column>
				<p:column colspan="3">
					#{SignProcessBean.signProcessForm.signProcess.processId}
				</p:column>
			</p:row>
			<p:row>
				<p:column style="width:120px">
					<i18n:outputText style="color:red;" value="NonNullMark" />簽核清單名稱：
			</p:column>
				<p:column>
					<p:inputText
						value="#{SignProcessBean.signProcessForm.signProcess.processName}"
						maxlength="25"
						rendered="#{SignProcessBean.signProcessForm.signProcess!=null}" />
				</p:column>
				<p:column style="width:120px">
					<i18n:outputText style="color:red;" value="NonNullMark" />簽核人員全部通知：
			</p:column>
				<p:column>
					<p:selectOneMenu
						value="#{SignProcessBean.signProcessForm.signProcess.notifyFlag}"
						rendered="#{SignProcessBean.signProcessForm.signProcess!=null}"
						style="width:50px;text-align:left;">
						<f:selectItem itemLabel="N" itemValue="N" />
						<f:selectItem itemLabel="Y" itemValue="Y" />
					</p:selectOneMenu>
				</p:column>
			</p:row>
			<p:row>
				<p:column style="width:120px">
					<i18n:outputText style="color:red;" value="NonNullMark" />系統來源：
			</p:column>
				<p:column>
					<p:selectOneMenu
						value="#{SignProcessBean.signProcessForm.signProcess.sourceSystem}"
						rendered="#{SignProcessBean.signProcessForm.signProcess!=null}"
						style="width:150px;">
						<f:selectItem itemLabel="請選擇" itemValue="" />
						<f:selectItems
							value="#{SignProcessBean.signProcessForm.signSourseSystem}" />
						<p:ajax
							update=":tabView:signProcessForm:sourceCategory"
							listener="#{SignProcessBean.onSystemChange}" />
					</p:selectOneMenu>
				</p:column>
				<p:column style="width:120px">
					系統來源分類：
			</p:column>
				<p:column>
					<p:selectOneMenu id="sourceCategory"
						value="#{SignProcessBean.signProcessForm.signProcess.sourceCategory}"
						rendered="#{SignProcessBean.signProcessForm.signProcess!=null}"
						style="width:180px;">
						<f:selectItem itemLabel="請選擇" itemValue="" />
						<f:selectItems
							value="#{SignProcessBean.signProcessForm.signSourseCategory}" />
					</p:selectOneMenu>
				</p:column>
			</p:row>
			<p:row>
				<p:column style="width:120px">
				說明：
			</p:column>
				<p:column colspan="3">
					<p:inputText
						value="#{SignProcessBean.signProcessForm.signProcess.description}"
						size="50" maxlength="100"
						rendered="#{SignProcessBean.signProcessForm.signProcess!=null}" />
				</p:column>
			</p:row>
			<p:row>
				<p:column style="width:120px">
				失效日期：
			</p:column>
				<p:column colspan="3">
					<p:calendar
						value="#{SignProcessBean.signProcessForm.signProcess.inactiveDate}"
						showOn="button" id="inactiveDate" readonlyInput="true"
						rendered="#{SignProcessBean.signProcessForm.signProcess!=null}" />
					<p:commandButton icon="ui-icon-close"
						rendered="#{SignProcessBean.signProcessForm.signProcess!=null}"
						update=":tabView:signProcessForm:inactiveDate">
						<f:setPropertyActionListener
							target="#{SignProcessBean.signProcessForm.signProcess.inactiveDate}"
							value="" />
					</p:commandButton>
				</p:column>
			</p:row>
			<p:row>
				<p:column style="width:120px">
				申請人：
			</p:column>
				<p:column style="width:120px">
				#{SignProcessBean.signProcessForm.createName}
			</p:column>
				<p:column style="width:120px">
				申請日期：
			</p:column>
				<p:column style="width:120px">
					<h:outputText
						value="#{SignProcessBean.signProcessForm.signProcess.createDate}">
						<f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss" timeZone="GMT+8" />
					</h:outputText>
				</p:column>
			</p:row>
			<p:row>
				<p:column style="width:120px">
				異動人：
			</p:column>
				<p:column style="width:120px">
				#{SignProcessBean.signProcessForm.changeName}
			</p:column>
				<p:column style="width:120px">
				異動日期：
			</p:column>
				<p:column style="width:120px">
					<h:outputText
						value="#{SignProcessBean.signProcessForm.signProcess.changeDate}">
						<f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss" timeZone="GMT+8" />
					</h:outputText>
				</p:column>
			</p:row>
		</p:panelGrid>
		<p:separator />
		<p:dataTable var="signProcessList" paginatorPosition="bottom"
			rowKey="#{signProcessList.signSequence}" id="signProcessList"
			value="#{SignProcessBean.signProcessForm.signProcessList}"
			rowIndexVar="inx"
			selection="#{SignProcessBean.signProcessForm.sDeleteSignProcessList}">
			<f:facet name="header">  
			簽核清單
				<p:commandButton icon="ui-icon-plus" value="新增"
					rendered="#{SignProcessBean.signProcessForm.signProcess.processId!=null}"
					actionListener="#{SignProcessBean.addSignProcessList}"
					update=":tabView:signProcessForm:signProcessList"
					
					 />
				<p:commandButton icon="ui-icon-plus" value="刪除"
					rendered="#{SignProcessBean.signProcessForm.signProcess.processId!=null}"
					actionListener="#{SignProcessBean.deleteSignProcessList}"
					update=":tabView:signProcessForm:signProcessList"
					
					 />
			</f:facet>

			<p:column selectionMode="multiple"
				style="text-align:center;width:20px" />

			<p:column style="text-align:center;">
				<f:facet name="header">
					簽核順序
			</f:facet>
				#{signProcessList.signSequence} <br />
				<p:commandButton icon="ui-icon-circle-triangle-n"
					update="signProcessList" style="width:20px;Height:20px;"
					rendered="#{signProcessList.signSequence!=1 
					and signProcessList.signSequence!=2}"
					actionListener="#{SignProcessBean.onChangeSequence(signProcessList,'UPPER')}" />
				<p:commandButton icon="ui-icon-circle-triangle-s"
					update="signProcessList" style="width:20px;Height:20px;"
					rendered="#{signProcessList.signSequence!=1
					and signProcessList.signSequence!=SignProcessBean.signProcessForm.signProcessList.size()}"
					actionListener="#{SignProcessBean.onChangeSequence(signProcessList,'DOWN')}" />
			</p:column>
			<p:column style="text-align:center;" id="signSequence">
				<f:facet name="header">
					<i18n:outputText style="color:red;" value="NonNullMark" />簽核類別
			</f:facet>
				<h:outputText value="送審人"
					rendered="#{signProcessList.signSequence==1}" />
				<p:selectOneMenu id="signCategory"
					rendered="#{signProcessList.signSequence!=1}"
					value="#{signProcessList.signCategory}"
					style="width:100px;text-align:left;">
					<f:selectItem itemLabel="請選擇" itemValue="" />
					<f:selectItems
						value="#{SignProcessBean.signProcessForm.signCategory}" />
					<p:ajax update="signProcessList" process="@form" />
				</p:selectOneMenu>
			</p:column>
			<p:column style="text-align:center;">
				<f:facet name="header">
					<i18n:outputText style="color:red;" value="NonNullMark" />簽核屬性
			</f:facet>
				<p:selectOneMenu id="signLevel"
					rendered="#{signProcessList.signCategory=='CONTINUE' or signProcessList.signSequence==1}"
					value="#{signProcessList.signLevel}"
					style="width:150px;text-align:left;">
					<f:selectItem itemLabel="請選擇" itemValue="" />
					<f:selectItems value="#{SignProcessBean.signProcessForm.signLevel}" />
				</p:selectOneMenu>
				<p:inputText value="#{signProcessList.signEmpNo}" size="14"
					readonly="true" id="signEmpNo"
					rendered="#{signProcessList.signCategory=='APPOINT'}" />
				<p:commandButton icon="ui-icon-search"
					rendered="#{signProcessList.signCategory=='APPOINT'}"
					
					
					oncomplete="PF('signHrDialog').show();">
					<f:setPropertyActionListener
						target="#{SignProcessBean.signProcessForm.signSequence}"
						value="#{signProcessList.signSequence}" />
					<f:setPropertyActionListener target="#{SignHrBean.object}"
						value="#{SignProcessBean}" />
					<f:setPropertyActionListener target="#{SignHrBean.updateView}"
						value="tabView:signProcessList" />
				</p:commandButton>
				<p:selectOneMenu id="signValidateFunction"
					rendered="#{signProcessList.signCategory=='VALIDATE' || signProcessList.signCategory=='FROM_SYSTEM'}"
					value="#{signProcessList.signValidateFunction}">
					<f:selectItem itemLabel="請選擇" itemValue="" />
					<f:selectItems
						value="#{SignProcessBean.signProcessForm.methodMap[signProcessList.signCategory]}" />
				</p:selectOneMenu>
			</p:column>
			<p:column style="text-align:center;">
				<f:facet name="header">
					驗證TRUE
			</f:facet>
				<p:selectOneMenu 
					rendered="#{signProcessList.signCategory=='VALIDATE'}"
					value="#{signProcessList.signValidateTrue}">
					<f:selectItem itemLabel="Select" itemValue="" />
					<f:selectItems
						value="#{SignProcessBean.signProcessForm.signSequenceMap}" />
				</p:selectOneMenu>
			</p:column>
			<p:column style="text-align:center;">
				<f:facet name="header">
					驗證FALSE
			</f:facet>
				<p:selectOneMenu 
					rendered="#{signProcessList.signCategory=='VALIDATE'}"
					value="#{signProcessList.signValidateFalse}">
					<f:selectItem itemLabel="Select" itemValue="" />
					<f:selectItems
						value="#{SignProcessBean.signProcessForm.signSequenceMap}" />
				</p:selectOneMenu>
			</p:column>
			<p:column style="text-align:center;">
				<f:facet name="header">
					簽核點描述
			</f:facet>
				<p:inputTextarea value="#{signProcessList.signDescription}" rows="2"
					cols="20" />
			</p:column>
			<p:column style="text-align:center;">
				<f:facet name="header">
					簽核上限
			</f:facet>
				<pe:inputNumber value="#{signProcessList.signPrice}"
					decimalPlaces="0" minValue="0" style="width:100px;" />
			</p:column>
		</p:dataTable>
	</h:form>
</ui:composition>
