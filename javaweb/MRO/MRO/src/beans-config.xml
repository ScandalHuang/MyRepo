<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
              	           http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
			   http://www.springframework.org/schema/aop 
			   http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
                           http://www.springframework.org/schema/tx 
                           http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
                           http://www.springframework.org/schema/context 
                           http://www.springframework.org/schema/context/spring-context-3.1.xsd"
>
    <context:component-scan base-package="mro.app"/> 
    <context:component-scan base-package="mro.base"/>
    <context:component-scan base-package="mro.quartz"/> 
	<!-- ========== DATA SOURCE ========== -->

      <bean id="DEFAULT_DATA_SOURCE" class="org.springframework.jndi.JndiObjectFactoryBean" scope="singleton">
        <property name="jndiName">
            <value>jdbc/CSP</value>
        </property>
        <property name="resourceRef">
            <value>true</value>
        </property>
    </bean>

	<!-- ========== HIBERNATE SessionFactory ========== -->
	
    <bean id="DEFAULT_SESSION_FACTORY" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean" scope="singleton">
        <property name="dataSource">
            <ref bean="DEFAULT_DATA_SOURCE"/>
        </property>
        <property name="packagesToScan">
        	<list>
        		<value>mro.base.entity</value>
        		 <!-- =====================自訂VO======================== --> 
        		<value>mro.app.item.vo</value>
	            	 <!-- =========================alitem======================== -->
        			<value>mro.app.alitem.vo</value>
                	<!-- =========================mro.app.applyItem======================== -->
                	<value>mro.app.applyItem.vo</value>
                	<!--  =========================COMMON VIEW =============== -->
                	<value>mro.app.commonview.vo</value>
                    <!--  =========================MAIL =============== -->
                    <value>mro.app.util.vo</value>
        	</list>
        </property>
        <property name="hibernateProperties">
            <props>
				<!-- 顯示實際操作資料庫時的SQL -->
                <prop key="hibernate.show_sql">true</prop>
				<!-- 將顯示的SQL排版，方便觀看 -->
                <prop key="hibernate.format_sql">true</prop>
				<!-- SQL方言，這邊設定的是OracleDriver -->
                <prop key="hibernate.dialect">org.hibernate.dialect.Oracle9iDialect</prop>
				<!-- 選擇Hibernate的查詢翻譯器 -->
                <!-- <prop key="hibernate.query.factory_class">org.hibernate.hql.classic.ClassicQueryTranslatorFactory</prop> -->
                <prop key="hibernate.query.factory_class">org.hibernate.hql.ast.ASTQueryTranslatorFactory</prop> 
				<!-- Hibernate將收集有助於性能調節的統計資料 -->
                <prop key="hibernate.generate_statistics">true</prop>
				<!-- Hibernate將在SQL中生成有助於調試的注釋資訊 -->
                <prop key="hibernate.use_sql_comments">true</prop>
				<!-- Hibernate無法進行Stream Batch更新，需設定Size為0 -->
                <prop key="hibernate.jdbc.batch_size">0</prop> 
            </props>
        </property>
    </bean>
	
	<!-- ========== TRANSACTION MANAGER ========== -->
    <bean id="transactionManager" 
          class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory">
            <ref bean="DEFAULT_SESSION_FACTORY"/>
        </property>	
    </bean>
</beans>
