
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:i18n="http://innolux.com/i18n">
	<h:form id="listExclusiveReturnForm" prependId="false"><i18n:outputText value="location.site" />：
		<p:selectOneMenu style="width:250px;" converter="SerializesConverter"
			value="#{ListExclusiveReturnBean.exclusiveReturnForm.sLocationSiteMap}"
			filter="true" filterMatchMode="startsWith" >
			<f:selectItem itemLabel="請選擇" itemValue="" />
			<f:selectItems value="#{LoginInfoBean.userLSMap.values()}" var="userLSMap"
								itemLabel="#{userLSMap.locationSite}"  itemValue="#{userLSMap}" />
			<p:ajax update="@form" listener="#{ListExclusiveReturnBean.onSearch}" process="@form" />
		</p:selectOneMenu>&#160;&#160;&#160;&#160;
		<i18n:outputText value="Category" />：
		<p:selectOneMenu value="#{ListExclusiveReturnBean.exclusiveReturnForm.type}"
			style="text-align:left;width:200px;">
							<f:selectItem itemValue="ITEM" itemLabel="料號" />
							<f:selectItem itemValue="CLASSSTRUCTUREID" itemLabel="類別" />
			<p:ajax update=":tabView:listExclusiveReturnForm"
				listener="#{ListExclusiveReturnBean.onSearch}" process="@form"  />
		</p:selectOneMenu>&#160;&#160;&#160;&#160;
		<c:if test="#{ListExclusiveReturnBean.exclusiveReturnForm.type=='ITEM'}">
			<i18n:outputText value="siteid" />：
			<p:selectOneMenu filter="true" filterMatchMode="contains"
								value="#{ListExclusiveReturnBean.exclusiveReturnForm.selectPlantCode}"
								style="text-align:left;width:200px;">
								<f:selectItem itemValue="" itemLabel="請選擇" />
								<f:selectItem itemValue="ALL" itemLabel="全部資料" />
								<f:selectItems value="#{SystemConfigBean.lOption}" />
				<p:ajax update=":tabView:listExclusiveReturnForm"
					listener="#{ListExclusiveReturnBean.onSearch}" process="@form"  />
			</p:selectOneMenu>
		</c:if>
		<br/><font color="red">*系統會依照選取的<i18n:outputText value="location.site" />進行新增</font>
		<br /><font color="red">*重複的CLASSSTRUCTUREID、ORGANIZATION_CODE、DEPT_CODE與ITEMNUM會在上傳後自動覆蓋</font>
		<p:dataTable var="listExclusiveReturn"
			value="#{ListExclusiveReturnBean.exclusiveReturnForm.list}"
			filterDelay="#{SystemConfigBean.filetDelay}"
			filteredValue="#{ListExclusiveReturnBean.exclusiveReturnForm.filterList}"
			paginator="true" rows="10" id="listExclusiveReturn"
			rowKey="#{listExclusiveReturn.uuid}"
			selection="#{ListExclusiveReturnBean.exclusiveReturnForm.deleteList}"
			paginatorPosition="bottom" style="text-align:center">
			<f:facet name="header">
				<i18n:outputText value="List.Exclusive.Return" />
				<p:commandButton value="選取全部" icon="ui-icon-circle-check"
					rendered="#{ListExclusiveReturnBean.exclusiveReturnForm.list.size()>0}"
					actionListener="#{ListExclusiveReturnBean.onSelectAll}" 
					update="listExclusiveReturn" />
				<p:commandButton value="刪除清單" icon="ui-icon-trash"
					rendered="#{ListExclusiveReturnBean.exclusiveReturnForm.list.size()>0}"
					oncomplete="PF('deleteConfirmErDialog').show();" />
			</f:facet>
			<p:column selectionMode="multiple" exportable="false"
				style="text-align:center;width:20px" />
			<p:column rendered="#{ListExclusiveReturnBean.exclusiveReturnForm.type!='ITEM'}">
				<f:facet name="header">
						CLASSSTRUCTUREID(類別結構)
				</f:facet>
				<h:outputText value="#{listExclusiveReturn.classstructureid}" />
			</p:column>
			<p:column rendered="#{ListExclusiveReturnBean.exclusiveReturnForm.type=='ITEM'}">
				<f:facet name="header">
						ORGANIZATION_CODE(廠區)
				</f:facet>
				<h:outputText value="#{listExclusiveReturn.organizationCode}" />
			</p:column >
			<p:column filterMatchMode="contains" filterBy="#{listExclusiveReturn.deptNo}"
				rendered="#{ListExclusiveReturnBean.exclusiveReturnForm.type=='ITEM'}">
				<f:facet name="header">
						DEPT_NO(部門)
				</f:facet>
				<h:outputText value="#{listExclusiveReturn.deptNo}" />
			</p:column >		
			<p:column filterMatchMode="contains" filterBy="#{listExclusiveReturn.itemnum}"
				rendered="#{ListExclusiveReturnBean.exclusiveReturnForm.type=='ITEM'}">
				<f:facet name="header">
						ITEMNUM(料號)
				</f:facet>
				<h:outputText value="#{listExclusiveReturn.itemnum}" />
			</p:column>
			<p:column filterMatchMode="contains" filterBy="#{listExclusiveReturn.remark}">
				<f:facet name="header">
						Remark(備註)
				</f:facet>
				<h:outputText value="#{listExclusiveReturn.remark}" />
			</p:column>
			<p:column exportable="false">
				<f:facet name="header">
					最後更新人
				</f:facet>
					<h:outputText value="#{listExclusiveReturn.createBy}" />
			</p:column>
			<p:column  filterMatchMode="contains" filterBy="#{listExclusiveReturn.createDate}">
				<f:facet name="header">
					建立日期
				</f:facet>
				<h:outputText
					value="#{listExclusiveReturn.createDate}">
					<f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss" timeZone="GMT+8" />
				</h:outputText>
			</p:column>
		</p:dataTable>
		<p:panelGrid columns="2">
			<p:panel header="Export All Data">
				<h:commandLink>
					<p:graphicImage value="../../resources/images/excel.png" />
					<p:dataExporter type="xls" target="listExclusiveReturn"
						fileName="#{currentDate.getTime()}E" />
				</h:commandLink>
			</p:panel>
			<p:panel header="Upload Data" 
				rendered="#{ListExclusiveReturnBean.exclusiveReturnForm.sLocationSiteMap!=null}">
				<i18n:outputText value="upload.excel" />：
					<p:commandButton icon="ui-icon-disk"
					update=":fileUploadExcelForm"
					action="#{FileUploadExcelBean.excel(6,1)}"
					 
					oncomplete="PF('ExcelFileUploadDialog').show();">
					<f:setPropertyActionListener target="#{FileUploadExcelBean.object}"
						value="#{ListExclusiveReturnBean}" />
					<f:setPropertyActionListener
						target="#{FileUploadExcelBean.updateView}"
						value="tabView:listExclusiveReturnForm" />
				</p:commandButton>
			</p:panel>
		</p:panelGrid>
	</h:form>
		
		<p:confirmDialog id="deleteConfirmErDialog" message="確定刪除清單?" width="300"
			header="確定刪除清單" widgetVar="deleteConfirmErDialog" appendTo="@(body)">
			<h:form id="deleteConfirmErForm" prependId="false">
				<p:commandButton value="Yes Sure"
					oncomplete="PF('deleteConfirmErDialog').hide();"
					actionListener="#{ListExclusiveReturnBean.onDelete}"
					update=":tabView:listExclusiveReturnForm"
					 
					icon="ui-icon-circle-check" />
				<p:commandButton value="Not Yet"
					onclick="PF('deleteConfirmErDialog').hide();" type="button"
					icon="ui-icon-close" />
			</h:form>
		</p:confirmDialog>
</ui:composition>
